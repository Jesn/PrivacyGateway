# GitHub Actions Docker æ„å»ºè®¾ç½®æŒ‡å—

æœ¬æ–‡æ¡£è¯´æ˜å¦‚ä½•è®¾ç½®GitHub Actionsæ¥è‡ªåŠ¨æ„å»ºå’Œæ¨é€Dockeré•œåƒåˆ°Docker Hubã€‚

## ğŸ”§ å‰ç½®è¦æ±‚

1. **GitHubä»“åº“** - ä»£ç å·²æ¨é€åˆ°GitHub
2. **Docker Hubè´¦æˆ·** - å·²åˆ›å»ºä»“åº“ `richpeople/privacy-gateway`
3. **Docker Hubè®¿é—®ä»¤ç‰Œ** - ç”¨äºGitHub Actionsè®¤è¯

## ğŸ“‹ è®¾ç½®æ­¥éª¤

### 1. åˆ›å»ºDocker Hubè®¿é—®ä»¤ç‰Œ

1. ç™»å½• [Docker Hub](https://hub.docker.com/)
2. ç‚¹å‡»å³ä¸Šè§’å¤´åƒ â†’ **Account Settings**
3. é€‰æ‹© **Security** æ ‡ç­¾
4. ç‚¹å‡» **New Access Token**
5. å¡«å†™ä»¤ç‰Œåç§°ï¼ˆå¦‚ï¼š`github-actions`ï¼‰
6. é€‰æ‹©æƒé™ï¼š**Read, Write, Delete**
7. ç‚¹å‡» **Generate** å¹¶**å¤åˆ¶ä»¤ç‰Œ**ï¼ˆåªæ˜¾ç¤ºä¸€æ¬¡ï¼‰

### 2. åœ¨GitHubä»“åº“ä¸­è®¾ç½®Secrets

1. è¿›å…¥GitHubä»“åº“é¡µé¢
2. ç‚¹å‡» **Settings** æ ‡ç­¾
3. å·¦ä¾§èœå•é€‰æ‹© **Secrets and variables** â†’ **Actions**
4. ç‚¹å‡» **New repository secret** æ·»åŠ ä»¥ä¸‹secretsï¼š

| Secretåç§° | å€¼ | è¯´æ˜ |
|-----------|---|------|
| `DOCKER_USERNAME` | ä½ çš„Docker Hubç”¨æˆ·å | ç”¨äºç™»å½•Docker Hub |
| `DOCKER_PASSWORD` | åˆšåˆ›å»ºçš„è®¿é—®ä»¤ç‰Œ | Docker Hubè®¿é—®ä»¤ç‰Œï¼ˆä¸æ˜¯å¯†ç ï¼‰ |

### 3. å·¥ä½œæµè§¦å‘æ¡ä»¶

GitHub Actionså°†åœ¨ä»¥ä¸‹æƒ…å†µè‡ªåŠ¨è§¦å‘ï¼š

- âœ… **æ¨é€åˆ°mainåˆ†æ”¯** - æ„å»ºå¹¶æ¨é€ `latest` æ ‡ç­¾
- âœ… **åˆ›å»ºç‰ˆæœ¬æ ‡ç­¾** - æ„å»ºå¹¶æ¨é€ç‰ˆæœ¬æ ‡ç­¾ï¼ˆå¦‚ `v1.0.0`ï¼‰
- âœ… **Pull Request** - ä»…æ„å»ºï¼Œä¸æ¨é€ï¼ˆç”¨äºæµ‹è¯•ï¼‰
- âœ… **æ‰‹åŠ¨è§¦å‘** - åœ¨Actionsé¡µé¢æ‰‹åŠ¨è¿è¡Œ

### 4. æ ‡ç­¾ç­–ç•¥

| è§¦å‘æ¡ä»¶ | ç”Ÿæˆçš„æ ‡ç­¾ | ç¤ºä¾‹ |
|---------|-----------|------|
| æ¨é€åˆ°mainåˆ†æ”¯ | `latest`, `main` | `richpeople/privacy-gateway:latest` |
| åˆ›å»ºæ ‡ç­¾ `v1.2.3` | `1.2.3`, `1.2`, `1`, `latest` | `richpeople/privacy-gateway:1.2.3` |
| Pull Request | `pr-123` | ä»…æ„å»ºï¼Œä¸æ¨é€ |

### 5. å¤šå¹³å°æ”¯æŒ

æ„å»ºçš„é•œåƒæ”¯æŒä»¥ä¸‹å¹³å°ï¼š
- `linux/amd64` (x86_64)
- `linux/arm64` (ARM64/Apple Silicon)

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### å‘å¸ƒæ–°ç‰ˆæœ¬

1. **åˆ›å»ºç‰ˆæœ¬æ ‡ç­¾**ï¼š
   ```bash
   git tag v1.0.0
   git push origin v1.0.0
   ```

2. **æ¨é€åˆ°mainåˆ†æ”¯**ï¼š
   ```bash
   git push origin main
   ```

### æ‰‹åŠ¨è§¦å‘æ„å»º

1. è¿›å…¥GitHubä»“åº“çš„ **Actions** é¡µé¢
2. é€‰æ‹© **Build and Push Docker Image** å·¥ä½œæµ
3. ç‚¹å‡» **Run workflow**
4. é€‰æ‹©åˆ†æ”¯å¹¶ç‚¹å‡» **Run workflow**

## ğŸ“Š æ„å»ºçŠ¶æ€

å¯ä»¥åœ¨ä»¥ä¸‹ä½ç½®æŸ¥çœ‹æ„å»ºçŠ¶æ€ï¼š

- **GitHub Actionsé¡µé¢**: `https://github.com/ä½ çš„ç”¨æˆ·å/PrivacyGateway/actions`
- **Docker Hubä»“åº“**: `https://hub.docker.com/r/richpeople/privacy-gateway`

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **è®¤è¯å¤±è´¥**
   - æ£€æŸ¥ `DOCKER_USERNAME` å’Œ `DOCKER_PASSWORD` secretsæ˜¯å¦æ­£ç¡®è®¾ç½®
   - ç¡®è®¤ä½¿ç”¨çš„æ˜¯è®¿é—®ä»¤ç‰Œï¼Œä¸æ˜¯å¯†ç 

2. **æ„å»ºå¤±è´¥**
   - æ£€æŸ¥Dockerfileè¯­æ³•
   - æŸ¥çœ‹Actionsæ—¥å¿—ä¸­çš„è¯¦ç»†é”™è¯¯ä¿¡æ¯

3. **æ¨é€å¤±è´¥**
   - ç¡®è®¤Docker Hubä»“åº“ `richpeople/privacy-gateway` å­˜åœ¨
   - æ£€æŸ¥è®¿é—®ä»¤ç‰Œæƒé™

### æŸ¥çœ‹æ„å»ºæ—¥å¿—

1. è¿›å…¥GitHubä»“åº“çš„ **Actions** é¡µé¢
2. ç‚¹å‡»å¤±è´¥çš„å·¥ä½œæµè¿è¡Œ
3. å±•å¼€ç›¸åº”çš„æ­¥éª¤æŸ¥çœ‹è¯¦ç»†æ—¥å¿—

## ğŸ¯ æœ€ä½³å®è·µ

1. **ç‰ˆæœ¬ç®¡ç†**
   - ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬å·ï¼ˆå¦‚ `v1.2.3`ï¼‰
   - ä¸ºé‡è¦ç‰ˆæœ¬åˆ›å»ºGitHub Release

2. **å®‰å…¨æ€§**
   - å®šæœŸè½®æ¢Docker Hubè®¿é—®ä»¤ç‰Œ
   - ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç æ•æ„Ÿä¿¡æ¯

3. **ç›‘æ§**
   - å…³æ³¨æ„å»ºå¤±è´¥é€šçŸ¥
   - å®šæœŸæ£€æŸ¥Docker Hubé•œåƒå¤§å°å’Œå®‰å…¨æ‰«æç»“æœ

## ğŸ“ å·¥ä½œæµæ–‡ä»¶è¯´æ˜

å·¥ä½œæµæ–‡ä»¶ä½ç½®ï¼š`.github/workflows/docker-build.yml`

ä¸»è¦åŠŸèƒ½ï¼š
- å¤šå¹³å°æ„å»ºï¼ˆAMD64 + ARM64ï¼‰
- æ™ºèƒ½æ ‡ç­¾ç®¡ç†
- GitHub Actionsç¼“å­˜ä¼˜åŒ–
- å®‰å…¨çš„Docker Hubæ¨é€
- å®Œæ•´çš„é•œåƒå…ƒæ•°æ®
